#include <stm32f429xx.h>		//INCLUDE THE HEADER FILE FOR THIS MCU FAMILY
													//this file contains the definitions for register addresses and values etc...


volatile int period;


void DAC_Init(void)
{
	RCC->AHB1ENR |= RCC_AHB1ENR_GPIOAEN;
	RCC->APB1ENR |= RCC_APB1ENR_DACEN;
	
	GPIOA->MODER |= GPIO_MODER_MODER4;
	
	DAC->CR |= DAC_CR_EN1;
}

void Set_Voltage(uint16_t voltage)
{
	voltage &= 0x0FFF;
	
	DAC->DHR12R1 = voltage;
}

int main(void)
{
	DAC_Init();
	
	/*while(1)
	{
		Set_Voltage(0);
		for(period=0; period<5000000; period++);
	
		Set_Voltage(2048);
		for(period=0; period<5000000; period++)
		
		Set_Voltage(4095);
		for(period=0; period<5000000; period++);
	
	
	}*/
	
	while(1)
	{
		Set_Voltage(0);
		for(period=0; period<5000000; period++);
		
		Set_Voltage(4095);
		for(period=0; period<5000000; period++);
	}
}
